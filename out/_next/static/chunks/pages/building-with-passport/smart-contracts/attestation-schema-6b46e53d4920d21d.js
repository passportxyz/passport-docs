(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1261],{4885:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/building-with-passport/smart-contracts/attestation-schema",function(){return s(7467)}])},7467:function(e,t,s){"use strict";s.r(t),s.d(t,{useTOC:function(){return o}});var a=s(1527),n=s(4859),i=s(4243),r=s(2816);function o(e){return[{value:"Passport (Stamp) attestation schema",id:"passport-stamp-attestation-schema",depth:2},{value:"Overview",id:"overview",depth:3},{value:"Fields",id:"fields",depth:3},{value:"Score attestation schema",id:"score-attestation-schema",depth:2},{value:"Fields",id:"fields-1",depth:3},{value:"Decoding Attestations",id:"decoding-attestations",depth:2}]}t.default=(0,n.c)((function(e){const{toc:t=o(e)}=e,s={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",span:"span",strong:"strong",ul:"ul",...(0,r.a)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(s.h1,{children:"Attestation schema"}),"\n",(0,a.jsx)(s.p,{children:"Onchain Passports use Attestations to verify that a particular address owns specific Stamps.\nUltimately, an Attestation is just a piece of data with a cryptographic signature."}),"\n",(0,a.jsx)(s.p,{children:"The data follows a known structure, known as a \u2018schema\u2019. The  schema is critical because it ensures the signing participant\nknows what they are signing, and provides a uniform data layout that enables users to decode the Attestations."}),"\n",(0,a.jsxs)(s.p,{children:["The schema is ",(0,a.jsx)(s.em,{children:"the layout of information being attested"}),".\nThe signature is the proof that a known, trusted verifier has seen the data and attested that it is truthful."]}),"\n",(0,a.jsx)(s.p,{children:"There are two attestations that are issued when users mint their Passports onchain, both of which are described below:"}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsx)(s.li,{children:"Passport (Stamp) attestation"}),"\n",(0,a.jsx)(s.li,{children:"Score attestation"}),"\n"]}),"\n",(0,a.jsx)(s.h2,{id:t[0].id,children:t[0].value}),"\n",(0,a.jsx)(s.h3,{id:t[1].id,children:t[1].value}),"\n",(0,a.jsx)(s.p,{children:"The raw schema looks as follows:"}),"\n",(0,a.jsx)(s.pre,{tabIndex:"0","data-language":"plaintext","data-word-wrap":"","data-copy":"",children:(0,a.jsx)(s.code,{children:(0,a.jsx)(s.span,{children:(0,a.jsx)(s.span,{children:"uint256[] providers, bytes32[] hashes, uint64[] issuanceDates, uint64[] expirationDates, uint16 providerMapVersion"})})})}),"\n",(0,a.jsx)(s.p,{children:"Notice that the types for all these fields are numerical types or raw bytes.\nThis is because the human-readable information is compressed and encoded before being added to the attestation."}),"\n",(0,a.jsx)(s.p,{children:"You can see an example of a Stamp attestation on the Optimism network by visiting the following link:"}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.a,{href:"https://optimism.easscan.org/attestation/view/0xd53526d72b9e9283a70894ddfba32513b722a939d85c1a6be402416d29cdc0b9",children:"Example Passport (Stamp) attestation on Optimism"})}),"\n",(0,a.jsx)(s.h3,{id:t[2].id,children:t[2].value}),"\n",(0,a.jsx)(s.p,{children:"The fields are as follows:"}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.code,{children:"providers"}),": a u256 that is actually a bitmap where each position maps to a provider name. The mapping is made available offchain."]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.code,{children:"hashes"}),": an ordered array of elements, with each element being 32 raw bytes. Each element in the array is a 32-byte hash that maps to a known Stamp. A provider might have multiple Stamps that each have a hash. The mapping is made available offchain."]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.code,{children:"issuanceDates"}),": an ordered array of elements, with each element being 32 raw bytes. Each element represents the UNIX timestamp when the Stamp was verified."]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.code,{children:"expirationDates"}),": an ordered array of elements, with each element being 32 raw bytes. Each element represents the UNIX timestamp when the Stamp expires."]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.code,{children:"providerMapVersion"}),": an unsigned integer specifying which version of the ",(0,a.jsx)(s.code,{children:"providers"})," mapping the Attestation conforms to. This allows updates as providers are added and removed from the canonical set."]}),"\n"]}),"\n",(0,a.jsx)(s.h2,{id:t[3].id,children:t[3].value}),"\n",(0,a.jsx)(s.p,{children:"The raw schema looks as follows:"}),"\n",(0,a.jsx)(s.pre,{tabIndex:"0","data-language":"plaintext","data-word-wrap":"","data-copy":"",children:(0,a.jsx)(s.code,{children:(0,a.jsx)(s.span,{children:(0,a.jsx)(s.span,{children:"uint256 score, uint32 scorer_id, uint8 score_decimals"})})})}),"\n",(0,a.jsx)(s.p,{children:"You can see an example of a score attestation on the Optimism network by visiting the following link:"}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.a,{href:"https://optimism.easscan.org/attestation/view/0x1d7832d2f4e5e71da3d8b0ceee72faf4cd44990057b21a26d9f775b911fe1bfe",children:"Example score attestation on Optimism"})}),"\n",(0,a.jsx)(s.h3,{id:t[4].id,children:t[4].value}),"\n",(0,a.jsx)(s.p,{children:"The fields are as follows:"}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.code,{children:"score"}),": the user\u2019s Passport score as an unsigned integer"]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.code,{children:"scorer_id"}),": the ID number for the specific Scorer instance that issued the ",(0,a.jsx)(s.code,{children:"score"})]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.code,{children:"score_decimals"}),": number of decimals in ",(0,a.jsx)(s.code,{children:"score"}),", similar to how ETH is divided into 1e18 Wei."]}),"\n"]}),"\n",(0,a.jsx)(s.h2,{id:t[5].id,children:t[5].value}),"\n",(0,a.jsxs)(s.p,{children:["The schema is used to encode and decode Attestations.\nFrom a raw attestation, you can extract the data that belongs to each field in the schema using an ABI decode method (such as ",(0,a.jsx)(s.code,{children:"abi.decode"})," in Solidity, ",(0,a.jsx)(s.code,{children:"abiCoder.decode()"})," in Ethers, etc) as follows:"]}),"\n",(0,a.jsx)(s.pre,{tabIndex:"0","data-language":"plaintext","data-word-wrap":"","data-copy":"",children:(0,a.jsxs)(s.code,{children:[(0,a.jsx)(s.span,{children:(0,a.jsx)(s.span,{children:"// Decode the attestion output"})}),"\n",(0,a.jsx)(s.span,{children:(0,a.jsx)(s.span,{children:"(providers, hashes, issuanceDates, expirationDates, providerMapVersion) = abi.decode("})}),"\n",(0,a.jsx)(s.span,{children:(0,a.jsx)(s.span,{children:"  attestation.data,"})}),"\n",(0,a.jsx)(s.span,{children:(0,a.jsx)(s.span,{children:"  (uint256[], bytes32[], uint64[], uint64[], uint16)"})}),"\n",(0,a.jsx)(s.span,{children:(0,a.jsx)(s.span,{children:");"})})]})}),"\n",(0,a.jsx)(s.p,{children:"You then need to apply some logic to the decoded data to extract actionable insights."}),"\n",(0,a.jsxs)(s.p,{children:["For example, you should extract the position indexes of each ",(0,a.jsx)(s.code,{children:"1"})," value in the ",(0,a.jsx)(s.code,{children:"providers"})," bitmap, then look up the ",(0,a.jsx)(s.code,{children:"Providers"})," at those same indexes in the providers mapping, found on the ",(0,a.jsx)(s.a,{href:"https://github.com/passportxyz/eas-proxy/blob/main/deployments/providerBitMapInfo.json",children:"Passport Github"}),"."]}),"\n",(0,a.jsxs)(s.p,{children:["You may also wish to extract each value from ",(0,a.jsx)(s.code,{children:"hashes"})," and find the matching entry in the Stamps mapping to determine which specific Stamps the Attestation contains."]}),"\n",(0,a.jsxs)(s.p,{children:["Similarly, you can determine the current time and check whether it is before or after the ",(0,a.jsx)(s.code,{children:"expirationDates"})," for each Stamp."]}),"\n",(0,a.jsxs)(s.p,{children:["You can see an example of how to do this in a Nextjs app in our ",(0,a.jsx)(s.a,{href:"./tutorials/integrating-onchain-stamp-data",children:"onchain Passports tutorial"}),"."]}),"\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.strong,{children:"Note"})," if you have more questions about the Attestation schema, you can chat in our ",(0,a.jsx)(s.a,{href:"https://t.me/+Mcp9RsRV7tVmYjZh",children:"developer support channel on Telegram"}),"."]})]})}),"/building-with-passport/smart-contracts/attestation-schema",{filePath:"pages/building-with-passport/smart-contracts/attestation-schema.mdx",timestamp:172911509e4,pageMap:i.v,frontMatter:{title:"Attestation schema",description:"Reference documentation for the Attestation schema used in Passport's smart contract stack."},title:"Attestation schema"},"undefined"===typeof RemoteContent?o:RemoteContent.useTOC)}},function(e){e.O(0,[4859,4243,9774,2888,179],(function(){return t=4885,e(e.s=t);var t}));var t=e.O();_N_E=t}]);